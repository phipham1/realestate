/**
 * @ngdoc object
 * @name app
 * @module app
 * @requires ui.select
 * @requires app.main
 * @requires app.table-mgmt
 * @requires app.sales-mgmt
 * @requires app.offer-mgmt
 * @requires app.form-samples-mgmt
 */
angular.module("app",["ui.select","app.main","app.table-mgmt","app.offer-mgmt","app.sales-mgmt","app.user-mgmt","app.form-samples-mgmt"]).config(["$locationProvider","uiSelectConfig",function(e,t){"use strict";e.html5Mode(!1),t.theme="bootstrap"}]).run(["globalSpinner",function(e){"use strict";e.showOnRouteChangeStartAndHideWhenComplete()}]),angular.module("app.form-samples-mgmt",["oasp.validation","oasp.oaspI18n","ui.router","app.form-samples-mgmt.templates"]).config(["$stateProvider","oaspTranslationProvider","$translatePartialLoaderProvider",function(e,t,n){"use strict";e.state("validationShowcase",{url:"/validation-showcase",templateUrl:"form-samples-mgmt/validation-showcase.html",resolve:{addTranslationPart:["$translate",function(e){return n.addPart("form-samples-mgmt"),e.use()?e.use():e.use(e.preferredLanguage())}]}}),t.enableTranslationForModule("form-samples-mgmt")}]),angular.module("app.form-samples-mgmt").config(["valdrProvider",function(e){"use strict";e.addConstraints({example1LoginType:{userName:{required:{message:"OASP.VALIDATION.SHOWCASE.USER_REQUIRED"},maxLength:{message:"OASP.VALIDATION.SHOWCASE.USER_MAX_LENGTH",number:20}},password:{required:{message:"OASP.VALIDATION.SHOWCASE.PSWD_REQUIRED"}}}})}]).controller("Example1Ctrl",function(){"use strict"}),angular.module("app.form-samples-mgmt").controller("Example2Ctrl",function(){"use strict";this.customMessageRepo={userName:{required:{msg:"OASP.VALIDATION.SHOWCASE.USER_REQUIRED"},maxlength:{msg:"OASP.VALIDATION.SHOWCASE.USER_MAX_LENGTH",params:{number:20}}},password:{required:{msg:"OASP.VALIDATION.SHOWCASE.PSWD_REQUIRED"}}}}),angular.module("app.form-samples-mgmt").controller("Example3Ctrl",["$timeout","$q",function(e,t){"use strict";function n(e,t){return-1!==e.indexOf(t,e.length-t.length)}var a=this;this.customMessageRepo={email:{forbidden:{msg:"OASP.VALIDATION.SHOWCASE.EMAIL_FORBIDDEN",params:{domain:"@forbidden.com"}},email:{msg:"OASP.VALIDATION.SHOWCASE.EMAIL_FORMAT"}}},this.isForbiddenDomain=function(e){return e&&n(e,"@forbidden.com")},this.isAllowedOnServer=function(n,r){var i=t.defer();return a.waitingForServer=!0,e(function(){n&&(r.$touched=!0),a.isForbiddenDomain(n)?(a.waitingForServer=!1,i.reject()):(a.waitingForServer=!1,i.resolve())},1500,!1),i.promise}}]),angular.module("app.form-samples-mgmt").controller("Example4Ctrl",function(){"use strict";this.customMessageRepo={password:{equal:{msg:"OASP.VALIDATION.SHOWCASE.PSWD_EQUAL"},required:{msg:"OASP.VALIDATION.SHOWCASE.PSWD_REQUIRED"}}}}),angular.module("app.form-samples-mgmt").config(["valdrProvider",function(e){"use strict";e.addConstraints({example5AsyncEmail:{forbiddenDomain:{maxLength:{message:"OASP.VALIDATION.SHOWCASE.DOMAIN_MAX_LENGTH",number:15}},asyncEmail:{required:{message:"OASP.VALIDATION.SHOWCASE.EMAIL_REQUIRED"},maxLength:{message:"OASP.VALIDATION.SHOWCASE.EMAIL_MAX_LENGTH",number:25}}}})}]).controller("Example5Ctrl",["$q","$timeout",function(e,t){"use strict";function n(e,t){return-1!==e.indexOf(t,e.length-t.length)}function a(e){var t=!1;return r.forbiddenDomains.forEach(function(a){return e&&n(e,a)?(r.customMessageRepo.asyncEmail.forbidden.params.domain=a,void(t=!0)):void 0}),t}var r=this,i=/@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}/;this.forbiddenDomains=this.forbiddenDomains||["@forbidden.com"],this.customMessageRepo={forbiddenDomain:{domainValid:{msg:"OASP.VALIDATION.SHOWCASE.DOMAIN_VALID"},notDuplicate:{msg:"OASP.VALIDATION.SHOWCASE.DOMAIN_DUPLICATE"}},asyncEmail:{forbidden:{msg:"OASP.VALIDATION.SHOWCASE.EMAIL_FORBIDDEN",params:{domain:void 0}},email:{msg:"OASP.VALIDATION.SHOWCASE.EMAIL_FORMAT"}}},this.addToBlacklist=function(e){r.forbiddenDomains.push(e),r.forbiddenDomainCandidate=void 0},this.removeFromBlacklist=function(e){r.forbiddenDomains.splice(e,1)},this.isValidDomain=function(e){return e&&null!==e.match(i)},this.isNotDuplicate=function(e){return e&&-1===r.forbiddenDomains.indexOf(e)},this.isAllowedOnServer=function(n,i){var o=e.defer();return r.waitingForServer=!0,t(function(){n&&(i.$touched=!0),a(n)?(r.waitingForServer=!1,o.reject()):(r.waitingForServer=!1,o.resolve())},1500,!1),o.promise}}]),angular.module("app.form-samples-mgmt.templates",[]).run(["$templateCache",function(e){e.put("form-samples-mgmt/validation-showcase.html",'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title></title></head><body><div class="validation-showcase container-fluid"><div class="row text-center"><div><h2>{{\'OASP.VALIDATION.SHOWCASE.DEMO_HEADER\' | translate}}</h2></div></div><div class="row"><div class="col-md-12"><div><p>{{\'OASP.VALIDATION.SHOWCASE.INTRO_PART1\' | translate}}</p><ul><li><a href="https://github.com/netceteragroup/valdr">valdr</a></li><li><a href="https://github.com/angular-ui/ui-validate">ui-validation</a></li></ul><p>{{\'OASP.VALIDATION.SHOWCASE.INTRO_PART2\' | translate}}</p></div></div></div><div class="row"><div class="col-sm-6 col-md-4 example"><ng-include src="\'form-samples-mgmt/examples/example1.html\'"></ng-include></div><div class="col-sm-6 col-md-8 example"><ng-include src="\'form-samples-mgmt/examples/example2.html\'"></ng-include></div></div><div class="row"><div class="col-sm-6 col-md-8 example"><ng-include src="\'form-samples-mgmt/examples/example3.html\'"></ng-include></div><div class="col-sm-6 col-md-4 example"><ng-include src="\'form-samples-mgmt/examples/example4.html\'"></ng-include></div></div><div class="row"><div class="col-md-8 col-md-offset-2 example"><ng-include src="\'form-samples-mgmt/examples/example5.html\'"></ng-include></div></div></div></body></html>'),e.put("form-samples-mgmt/examples/example1.html",'<div ng-controller="Example1Ctrl as E1C"><h2>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE1.NAME\' | translate}}</h2><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE1.DESCRIPTION\' | translate}}</p><form name="example1Form" novalidate="" valdr-type="example1LoginType"><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.USER.LABEL\' | translate}}</label><div with-validation-messages=""><input class="form-control" type="text" name="userName" data-ng-model="E1C.username" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.USER.PLACEHOLDER\' | translate}}"></div></div><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.PASSWORD.LABEL\' | translate}}</label><div with-validation-messages=""><input type="password" name="password" class="form-control" data-ng-model="E1C.password" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.PASSWORD.PLACEHOLDER\' | translate}}"></div></div></form></div>'),e.put("form-samples-mgmt/examples/example2.html",'<div ng-controller="Example2Ctrl as E2C"><h2>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE2.NAME\' | translate}}</h2><div class="row"><div class="col-md-6 col-md-push-6"><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE2.DESCRIPTION\' | translate}}</p><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE2.EXPLANATION\' | translate}}</p></div><div class="col-md-6 col-md-pull-6"><form name="example2Form" novalidate=""><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.USER.LABEL\' | translate}}</label><div with-validation-messages="E2C.customMessageRepo.userName"><input type="text" name="userName" class="form-control" data-ng-model="E2C.userName" required="true" ng-maxlength="20" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.USER.PLACEHOLDER\' | translate}}"></div></div><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.PASSWORD.LABEL\' | translate}}</label><div with-validation-messages="E2C.customMessageRepo.password"><input type="password" name="password" class="form-control" data-ng-model="E2C.password" required="true" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE.PASSWORD.PLACEHOLDER\' | translate}}"></div></div></form></div></div></div>'),e.put("form-samples-mgmt/examples/example3.html",'<div ng-controller="Example3Ctrl as E3C"><h2>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.NAME\' | translate}}</h2><div class="row"><div class="col-md-6"><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.DESCRIPTION\' | translate}}</p><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.HINT\' | translate}}</p></div><div class="col-md-6"><form name="example3Form" novalidate=""><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.EMAIL.LABEL\' | translate}}</label><div with-validation-messages="E3C.customMessageRepo.email"><input name="email" type="email" ng-model="E3C.email" class="form-control" ui-validate="{forbidden : \'!E3C.isForbiddenDomain($value)\' }" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.EMAIL.PLACEHOLDER\' | translate}}"></div></div><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.EMAIL.LABEL_ASYNC\' | translate}}</label><div with-validation-messages="E3C.customMessageRepo.email"><input name="asyncEmail" type="email" ng-model="E3C.asyncEmail" ng-model-options="{ debounce: 400 }" class="form-control" ui-validate-async="{forbidden : \'E3C.isAllowedOnServer($value, example3Form.asyncEmail)\' }" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE3.EMAIL.PLACEHOLDER\' | translate}}"></div><span ng-show="E3C.waitingForServer">{{\'OASP.VALIDATION.SHOWCASE.SERVER.PENDING\' | translate}}</span> <span ng-show="!E3C.waitingForServer">{{\'OASP.VALIDATION.SHOWCASE.SERVER.NO_REQUESTS\' | translate}}</span> <span ng-show="!E3C.waitingForServer && example3Form.asyncEmail.$touched">{{\'OASP.VALIDATION.SHOWCASE.SERVER.COMPLETED\' | translate}}</span></div></form></div></div></div>'),e.put("form-samples-mgmt/examples/example4.html",'<div ng-controller="Example4Ctrl as E4C"><h2>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE4.NAME\' | translate}}</h2><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE4.DESCRIPTION\' | translate}}</p><form name="example4Form" novalidate=""><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE4.PASSWORD.LABEL\' | translate}}</label><div with-validation-messages="E4C.customMessageRepo.password"><input class="form-control" name="password" type="text" ng-model="password" required="" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE4.PASSWORD.PLACEHOLDER\' | translate}}"></div><div with-validation-messages="E4C.customMessageRepo.password"><input class="form-control" name="confirm_password" type="text" ng-model="confirm_password" required="" ui-validate="{equal: \'$value==password\'}" ui-validate-watch="\'password\'" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE4.PASSWORD.CONFIRM_PLACEHOLDER\' | translate}}"></div></div></form></div>'),e.put("form-samples-mgmt/examples/example5.html",'<div ng-controller="Example5Ctrl as E5C"><h2>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.NAME\' | translate}}</h2><p>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.DESCRIPTION\' | translate}}</p><form name="example5Form" novalidate="" valdr-type="example5AsyncEmail"><div class="form-group"><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.FORBIDDEN_DOMAIN.LABEL\' | translate}}</label><div class="container-fluid"><div class="row add-domain"><div class="col-xs-8 inputDomain"><div with-validation-messages="E5C.customMessageRepo.forbiddenDomain"><input name="forbiddenDomain" ng-model="E5C.forbiddenDomainCandidate" class="form-control" type="text" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.FORBIDDEN_DOMAIN.PLACEHOLDER\' | translate}}" ui-validate="{domainValid : \'E5C.isValidDomain($value)\', notDuplicate: \'E5C.isNotDuplicate($value)\' }"></div></div><div class="col-xs-4 buttonDomain"><button type="button" class="btn btn-success" ng-click="E5C.addToBlacklist(E5C.forbiddenDomainCandidate)" ng-disabled="!example5Form.forbiddenDomain.$valid">{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.FORBIDDEN_DOMAIN.ADD_BLACKLIST\' | translate}}</button></div></div><div class="row"><alert ng-repeat="domain in E5C.forbiddenDomains" class="col-xs-6 col-md-4" type="danger" close="E5C.removeFromBlacklist($index)">{{domain}}</alert></div></div><label>{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.EMAIL.LABEL\' | translate}}</label><div with-validation-messages="E5C.customMessageRepo.asyncEmail"><input name="asyncEmail" type="email" class="form-control" ng-model="E5C.asyncEmail" ng-model-options="{ debounce: 400 }" ui-validate-watch-collection="\'E5C.forbiddenDomains\'" ui-validate-async="{forbidden : \'E5C.isAllowedOnServer($value, example5Form.asyncEmail)\' }" placeholder="{{\'OASP.VALIDATION.SHOWCASE.EXAMPLE5.EMAIL.PLACEHOLDER\' | translate}}"></div><span ng-show="E5C.waitingForServer">{{\'OASP.VALIDATION.SHOWCASE.SERVER.PENDING\' | translate}}</span> <span ng-show="!E5C.waitingForServer">{{\'OASP.VALIDATION.SHOWCASE.SERVER.NO_REQUESTS\' | translate}}</span> <span ng-show="!E5C.waitingForServer && example5Form.asyncEmail.$touched">{{\'OASP.VALIDATION.SHOWCASE.SERVER.COMPLETED\' | translate}}</span></div></form></div>')}]),angular.module("app.main",["ui.router","oasp.oaspUi","oasp.oaspSecurity","app.main.templates","oasp.validation","oasp.oaspI18n","ui.bootstrap"]).constant("SIGN_IN_DLG_PATH","/main/sign-in").constant("ROLES",{COOK:"COOK",WAITER:"WAITER"}).config(["SIGN_IN_DLG_PATH","$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider","oaspTranslationProvider","valdrProvider",function(e,t,n,a,r,i){"use strict";a.strictMode(!1),n.rule(function(e,t){var n=t.path(),a=n&&"/"===n[n.length-1];return a?n.substr(0,n.length-1):void 0}),n.otherwise(function(e,t){var n=e.get("$state");return n.go("notFound"),t.path()}),n.when("",["homePageRedirector",function(e){e.redirect()}]),n.when(e,["homePageRedirector",function(e){e.redirect()}]),t.state("notFound",{templateUrl:"main/layout/page-not-found.html"}).state("signIn",{url:e,templateUrl:"main/sign-in/sign-in.html",controller:"SignInCntl",controllerAs:"SIC"}),r.enableTranslationForModule("main",!0),r.setSupportedLanguages([{key:"en",label:"English","default":!0},{key:"de",label:"German"}]),i.addConstraints({LoginData:{userName:{required:{message:"Please enter your user name!"}},password:{required:{message:"Please enter your password!"}}}})}]),angular.module("app.main").controller("AppCntl",["SIGN_IN_DLG_PATH","$scope","$location","$window","appContext","oaspSecurityService","globalSpinner","$state",function(e,t,n,a,r,i,o,s){"use strict";r.getCurrentUser().then(function(e){t.currentUser=e}),t.logOff=function(){var e=function(){s.go("signIn",{},{reload:!0})};o.decorateCallOfFunctionReturningPromise(function(){return i.logOff()}).then(function(){e()})}}]),angular.module("app.main").factory("appContext",["oaspSecurityService","$q",function(e,t){"use strict";var n={isLoggedIn:!1},a=function(e){return{isLoggedIn:function(){return e.isLoggedIn},getUserRoles:function(){return e.profile&&e.profile.role},getUserName:function(){var t="";return e.profile&&e.profile.firstName&&e.profile.lastName&&(t=e.profile.firstName+" "+e.profile.lastName),t},getUserId:function(){return e.profile&&e.profile.id},getHomeDialogPath:function(){return e.profile&&e.profile.homeDialogPath||""}}},r=function(e){n.isLoggedIn=!0,n.profile=e,angular.isUndefined(e.homeDialogPath)&&(n.profile.homeDialogPath="WAITER"===e.role?"/table-mgmt/table-search":"COOK"===e.role?"/sales-mgmt/cook-positions":"/table-mgmt/table-search")},i=function(){n.isLoggedIn=!1,n.profile=void 0},o=function(){var o=t.defer();return e.getCurrentUserProfile().then(function(e){e?r(e):i(),o.resolve(a(n))}),o.promise};return{getUserRoles:function(){return o().then(function(e){return e.getUserRoles()})},getCurrentUser:o,onLoggingIn:function(e){r(e)},onLoggingOff:function(){i()}}}]),angular.module("app.main").factory("authenticator",["$modal",function(e){"use strict";return{execute:function(){return e.open({templateUrl:"main/sign-in/sign-in-modal.html",backdrop:"static",keyboard:!1,controller:"SignInModalCntl as SIC",size:"sm"}).result}}}]),angular.module("app.main").factory("securityRestService",["$http","currentContextPath",function(e,t){"use strict";var n=t.get()+"services/rest/";return{getCurrentUser:function(){return e.get(n+"security/v1/currentuser/")},getCsrfToken:function(){return e.get(n+"security/v1/csrftoken/")},login:function(t,a){return e.post(n+"login",{j_username:t,j_password:a})},logout:function(){return e.get(n+"logout")}}}]),angular.module("app.main").controller("SignInModalCntl",["$scope","signIn",function(e,t){"use strict";function n(){e.$close()}this.getLoginForm=function(){return e.loginForm},t(this,n)}]),angular.module("app.main").controller("SignInCntl",["$scope","$location","appContext","signIn",function(e,t,n,a){"use strict";function r(){n.getCurrentUser().then(function(e){t.url(e.getHomeDialogPath())})}this.getLoginForm=function(){return e.loginForm},a(this,r)}]),angular.module("app.main").factory("signIn",["oaspSecurityService","globalSpinner",function(e,t){"use strict";return function(n,a){n.errorMessage={text:"",hasOne:function(){return this.text?!0:!1},clear:function(){this.text=""}},n.credentials={},n.validation={userNameNotProvided:function(){return(n.getLoginForm().userName.$dirty||this.forceShowingValidationErrors)&&n.getLoginForm().userName.$error.required},passwordNotProvided:function(){return(n.getLoginForm().password.$dirty||this.forceShowingValidationErrors)&&n.getLoginForm().password.$error.required},forceShowingValidationErrors:!1},n.signIn=function(){var r=function(e){n.errorMessage.text=e,n.credentials={},n.validation.forceShowingValidationErrors=!1,n.getLoginForm().$setPristine(),n.getLoginForm().$setUntouched()};n.getLoginForm().$invalid?n.validation.forceShowingValidationErrors=!0:t.decorateCallOfFunctionReturningPromise(function(){return e.logIn(n.credentials.username,n.credentials.password)}).then(function(){a()},function(){r("Authentication failed. Please try again!")})}}}]),angular.module("app.main").directive("errorLog",["oaspErrorNotificatorService",function(e){"use strict";return{restrict:"EA",replace:!0,templateUrl:"main/error-log/error-log.html",link:function(t){t.errorLog=e.getErrorLog()}}}]),angular.module("app.main").factory("currentContextPath",["$window",function(e){"use strict";var t="";return{get:function(){var n,a,r,i=t?!1:!0;return i&&(t="/",n=e.location.pathname,n&&(a=n.split("/"),a.length>1&&(r=a[1],r&&(t+=r+"/")))),t}}}]),angular.module("app.main").factory("homePageRedirector",["$location","appContext","$q","$state",function(e,t,n,a){"use strict";var r={};return r.redirect=function(){return t.getCurrentUser().then(function(t){t.isLoggedIn()?e.url(t.getHomeDialogPath()):a.go("signIn")})},r}]),angular.module("app.main.templates",[]).run(["$templateCache",function(e){e.put("main/layout/blank.html","<!DOCTYPE html><html><body><div></div></body></html>"),e.put("main/layout/page-not-found.html",'<!DOCTYPE html><html><body><div class="row"><div class="col-md-12"><h2 translate="">OASP.PAGE_NOT_FOUND</h2><p translate="">OASP.PAGE_NOT_FOUND_DETAILS</p></div></div></body></html>'),e.put("main/sign-in/sign-in-alert.html",'<alert data-ng-show="SIC.errorMessage.hasOne()" data-close="SIC.errorMessage.clear()" data-type="danger"><span data-ng-bind="SIC.errorMessage.text"></span></alert>'),e.put("main/sign-in/sign-in-inputs.html",'<div class="form-group" with-validation-messages=""><input type="text" placeholder="User Name" name="userName" class="form-control" data-ng-model="SIC.credentials.username"></div><div class="form-group" with-validation-messages=""><input type="password" placeholder="Password" name="password" class="form-control" data-ng-model="SIC.credentials.password"></div>'),e.put("main/sign-in/sign-in-modal.html",'<div><form name="loginForm" novalidate="" valdr-type="LoginData"><div class="modal-header"><h3 class="modal-title">Sign In</h3></div><div class="modal-body"><div class="row"><div class="col-md-12"><ng-include src="\'main/sign-in/sign-in-alert.html\'"></ng-include><ng-include src="\'main/sign-in/sign-in-inputs.html\'"></ng-include></div></div></div><div class="modal-footer"><button class="btn btn-success" data-ng-click="SIC.signIn()">Sign In</button> <button class="btn btn-warning" ng-click="$dismiss()">Cancel</button></div></form></div>'),e.put("main/sign-in/sign-in.html",'<!DOCTYPE html><html><body><div class="row"><div class="row"><div class="col-md-8"><h1>This is the login to the devonfw restaurant example application as technical showcase for an AngularJS client.</h1><p><img src="main/img/login_logo.png"></p></div></div><div class="row"><div class="col-md-4"><h2>Sign In</h2><ng-include src="\'main/sign-in/sign-in-alert.html\'"></ng-include><form name="loginForm" novalidate="" valdr-type="LoginData"><ng-include src="\'main/sign-in/sign-in-inputs.html\'"></ng-include><button type="submit" class="btn btn-success" data-ng-click="SIC.signIn()">Sign In</button></form></div></div></div></body></html>'),e.put("main/error-log/error-log.html",'<li class="dropdown language-dropdown" dropdown=""><a href="" class="dropdown-toggle" dropdown-toggle=""><span class="icon-container"><span class="icon glyphicon glyphicon-comment"></span></span> <span translate="">OASP.ERROR_LOG</span> <span class="caret"></span></a><ul class="dropdown-menu" role="menu error-log-group"><li data-ng-show="errorLog.length==0"><a><span translate="">OASP.NO_ERROR</span></a></li><li ng-repeat="errorr in errorLog"><a><h5><strong>{{errorr.statusText}}</strong> <small>{{errorr.date.toLocaleTimeString()}}</small></h5><h5>{{errorr.data.message}}</h5></a></li></ul></li>')}]),angular.module("oasp",["oasp.oaspUi","oasp.oaspSecurity","oasp.oaspI18n"]),angular.module("oasp.oaspSecurity",[]).config(["$httpProvider",function(e){"use strict";e.interceptors.push("oaspSecurityInterceptor")}]).run(["oaspSecurityService",function(e){"use strict";e.checkIfUserIsLoggedInAndIfSoReinitializeAppContext()}]),angular.module("oasp.oaspUi",["oasp.oaspUi.oaspGrid","oasp.oaspUi.spinner","oasp.oaspUi.modal","oasp.oaspUi.buttonBar","oasp.oaspUi.errorNotificator"]),angular.module("oasp.validation",["valdr","ui.validate","ui.bootstrap","oasp.oaspI18n"]),angular.module("oasp.oaspI18n",["pascalprecht.translate","oasp.templates"],["$translateProvider","$httpProvider",function(e,t){"use strict";t.interceptors.push("templateLoadTranslationInterceptor"),e.useLoader("$translatePartialLoader",{urlTemplate:"{part}/i18n/locale-{lang}.json"})}]).run(["$rootScope","$translate","$translatePartialLoader",function(e,t,n){"use strict";var a=function(e){n.addPart(e),t.refresh()};e.$on("translationPartChange",function(e,t){a(t,e)})}]),angular.module("oasp.oaspUi.buttonBar",["oasp.templates"]),angular.module("oasp.oaspUi.errorNotificator",["oasp.templates","angular-growl","ngAnimate"]).config(["$httpProvider","growlProvider",function(e,t){"use strict";t.globalTimeToLive(2500),t.globalDisableCountDown(!0),t.onlyUniqueMessages(!1),t.globalPosition("top-right"),e.interceptors.push("oaspErrorNotificatorInterceptor")}]),angular.module("oasp.oaspUi.modal",["oasp.oaspUi.spinner","ui.bootstrap.modal","oasp.templates"]),angular.module("oasp.oaspUi.spinner",["angularSpinner","oasp.templates"]),angular.module("oasp.oaspUi.oaspGrid",["oasp.templates","trNgGrid"]).run(function(){"use strict";TrNgGrid.tableCssClass="tr-ng-grid table table-striped"}),angular.module("oasp.oaspSecurity").directive("hideIfUserHasRole",["oaspAuthorizationService",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,a){var r="ng-hide";t.$watch(a.hideIfUserHasRole,function(t){angular.isDefined(t)&&e.userHasAnyRole(t).then(function(e){n[e?"addClass":"removeClass"](r)})})}}}]),angular.module("oasp.oaspSecurity").provider("oaspAuthorizationService",function(){"use strict";function e(e){angular.forEach(e,function(t,a){if(Array.isArray(t)){var r,i=e[a].pop();e[a]=t.concat([n.appContextServiceName,"$q"]),r="function"==typeof i?function(){var e=arguments,t=e[e.length-2],n=e[e.length-1],a=n.defer();return t.getCurrentUser().then(function(){i.apply(this,e).then(a.resolve,a.reject)},a.reject),a.promise}:i,e[a].push(r)}})}var t,n={appContextServiceName:"appContext"},a=function(e){if(angular.isString(e))return[e];if(angular.isArray(e))return e;throw new Error("String or array of strings expected")};return{setAppContextServiceName:function(e){n.appContextServiceName=e||n.appContextServiceName},mapRoles:function(e){t=e},usersHavingAnyRoleOf:function(t){var n=a(t);return{mayGoToStateDefinedAs:function(t){var a;return t&&(a=t.resolve||{},e(a),a.authorize=function(e){return e.authorizationCheckResolver(n)},a.authorize.$inject=["oaspAuthorizationService"]),t}}},$get:["$q","$log","$injector",function(e,t,r){var i=function(){return r.get(n.appContextServiceName)},o=function(e){return i().getUserRoles().then(function(t){if(t){var n,r=a(t),i=a(e),o=function(e){return-1!==r.indexOf(e)};for(n=0;n<i.length;n++)if(o(i[n]))return!0}return!1})};return{authorizationCheckResolver:function(n){var a=e.defer();return o(n).then(function(e){e?a.resolve(!0):(t.warn("Access denied. Any role of '"+n+"' required to go to this state"),a.reject())}),a.promise},userHasAnyRole:o}}]}}),angular.module("oasp.oaspSecurity").directive("showIfUserHasAnyRole",["oaspAuthorizationService",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,a){var r="ng-hide";t.$watch(a.showIfUserHasAnyRole,function(t){angular.isDefined(t)&&e.userHasAnyRole(t).then(function(e){n[e?"removeClass":"addClass"](r)})})}}}]),angular.module("oasp.oaspSecurity").factory("oaspSecurityInterceptor",["$q","oaspUnauthenticatedRequestResender",function(e,t){"use strict";return{responseError:function(n){var a;return 403===n.status?(a=n.config,t.addRequest(a)):e.reject(n)}}}]),angular.module("oasp.oaspSecurity").provider("oaspSecurityService",function(){"use strict";var e={securityRestServiceName:"securityRestService",appContextServiceName:"appContext"};return{setSecurityRestServiceName:function(t){e.securityRestServiceName=t||e.securityRestServiceName},setAppContextServiceName:function(t){e.appContextServiceName=t||e.appContextServiceName},$get:["$injector","$http","$q",function(t,n,a){var r={set:function(e,t){this.headerName=e,this.token=t},invalidate:function(){this.headerName=void 0,this.token=void 0}},i=function(){return{hasToken:function(){return r.headerName&&r.token?!0:!1},getHeaderName:function(){return r.headerName},getToken:function(){return r.token}}}(),o=function(){var e,t,n=!1;return{initializationStarts:function(){n=!0,t=a.defer()},initializationSucceeded:function(a){e=a,n=!1,t.resolve(e),t=void 0},initializationFailed:function(){e=void 0,n=!1,t.resolve(e),t=void 0},userLoggedOff:function(){e=void 0},getProfile:function(){return n?t.promise:a.when(e)}}}(),s=function(){return t.get(e.securityRestServiceName)},l=function(){return t.get(e.appContextServiceName)},u=function(){return s().getCsrfToken().then(function(e){var t=e.data;return n.defaults.headers.post[t.headerName]=t.token,n.defaults.headers.put[t.headerName]=t.token,n.defaults.headers["delete"]={},n.defaults.headers["delete"][t.headerName]=t.token,r.set(t.headerName,t.token),t},function(){return a.reject("Requesting a CSRF token failed")})};return{logIn:function(e,t){var n=a.defer();return o.initializationStarts(),s().login(e,t).then(function(){a.all([s().getCurrentUser(),u()]).then(function(e){var t=e[0].data;o.initializationSucceeded(t),l().onLoggingIn(t),n.resolve()},function(e){o.initializationFailed(),n.reject(e)})},function(){o.initializationFailed(),n.reject("Authentication failed")}),n.promise},logOff:function(){return s().logout().then(function(){r.invalidate(),o.userLoggedOff(),l().onLoggingOff()})},getCurrentCsrfToken:function(){return i},checkIfUserIsLoggedInAndIfSoReinitializeAppContext:function(){o.initializationStarts(),s().getCurrentUser().then(function(e){var t=e.data;u().then(function(){o.initializationSucceeded(t),l().onLoggingIn(t)},function(){o.initializationFailed()})},function(){o.initializationFailed()})},getCurrentUserProfile:function(){return o.getProfile()}}}]}}),angular.module("oasp.oaspSecurity").provider("oaspUnauthenticatedRequestResender",function(){"use strict";var e={authenticatorServiceName:"authenticator"};return{setAuthenticatorServiceName:function(t){e.authenticatorServiceName=t||e.authenticatorServiceName},$get:["$q","$injector",function(t,n){var a={queue:[],push:function(e){this.queue.push(e)},resendAll:function(e){for(;this.queue.length;)this.queue.shift().resend(e)},cancelAll:function(){for(;this.queue.length;)this.queue.shift().cancel()}},r=function(){return n.get("oaspSecurityService")},i=function(){return n.get(e.authenticatorServiceName)},o=function(){var e=!0;return function(t,n){e&&(i().execute().then(function(){t(),e=!0},function(){n(),e=!0}),e=!1)}}();return{addRequest:function(e){var i=t.defer(),s={resend:function(t){var a=function(e,t){var a=n.get("$http");return e.headers[t.headerName]=t.token,a(e)};a(e,t).then(function(e){i.resolve(e)},function(e){i.reject(e)})},cancel:function(){i.reject()}},l=function(){var e=r().getCurrentCsrfToken();a.resendAll({headerName:e.getHeaderName(),token:e.getToken()})},u=function(){a.cancelAll()};return a.push(s),o(l,u),i.promise}}}]}}),angular.module("oasp.validation").directive("withValidationMessages",["$log",function(e){function t(e){var t,n=1;return angular.forEach(e,function(e){return e.nodeType===n?void(t=e):void 0}),t}function n(e,t){var n=!1,a=t.valdrViolations;return angular.forEach(a,function(t){return e===t.validator?void(n=!0):void 0}),n}function a(e){return-1===u.indexOf(e)}function r(e){var t=[];return angular.forEach(e.valdrViolations,function(r){var i={};n(r.validator,e)&&(angular.forEach(r,function(e,t){a(t)&&(i[t]=r[t])}),t.push({text:r.message,params:i}))}),t}function i(e,t){if("valdr"===e.substring(0,5))return!1;var n=t.$error;return angular.isDefined(n[e])}function o(t,n){var a=[];return angular.forEach(t.$error,function(r,o){if(i(o,t)){var s=n[o];angular.isUndefined(s)&&e.warn("There is no custom error definition available for detected error: '"+o+"'. Please check your configuration."),a.push({text:s?s.msg:"Unknown: "+o,params:s?s.params||{}:{}})}}),a}function s(e,t){var n=!1;return angular.forEach(e,function(a,r){return angular.isDefined(t)&&t.hasOwnProperty(r)?e[r]!==t[r]?void(n=!0):void 0:void(n=!0)}),n}function l(e,t){if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n].text!==t[n].text)return!0;return!1}var u=["field","message","type","valid","validator","value"];return{restrict:"A",require:"^form",replace:!0,transclude:!0,templateUrl:"oasp/oasp-validation/validation-messages.html",scope:{customErrorMessages:"=?withValidationMessages"},link:function(e,n,a,i,u){function c(e){var t=d().valdrViolations||[],n=d().$error;return(s(n,p)||l(t,m))&&(m=angular.copy(t),p=angular.copy(n),g=r(d()).concat(o(d(),e))),g}var d,m=[],p=[],g=[];u(function(e){var a=t(e),r=a.getAttribute("name")||a.getAttribute("data-name");d=function(){return i[r]},n.find(".input-with-validation-messages").prepend(e)}),e.customErrorMessages=e.customErrorMessages||{},e.isInputInvalid=function(){return angular.isUndefined(d())?!1:(d().$touched||i.$submitted)&&d().$valid===!1},e.items=function(){return c(e.customErrorMessages)}}}}]),angular.module("oasp.oaspUi.buttonBar").directive("buttonBar",function(){"use strict";return{restrict:"EA",replace:!0,templateUrl:"oasp/oasp-ui/button-bar/button-bar.html",scope:{buttonDefs:"=",isLabelTranslatable:"@"},link:function(e){e.onButtonClick=function(e){e&&angular.isFunction(e.onClick)&&e.onClick.apply(void 0,arguments)},e.isButtonDisabled=function(e){return e&&angular.isFunction(e.isActive)?!e.isActive.apply(void 0,arguments):e&&angular.isFunction(e.isNotActive)?e.isNotActive.apply(void 0,arguments):!0}}}}),angular.module("oasp.oaspUi.errorNotificator").service("oaspErrorNotificatorInterceptor",["$q","growl","oaspErrorNotificatorService",function(e,t,n){"use strict";return{responseError:function(a){return a&&(n.logError(a),t.error(a.data.message?a.data.message:"",{title:a.statusText})),e.reject(a)}}}]),angular.module("oasp.oaspUi.errorNotificator").service("oaspErrorNotificatorService",function(){"use strict";function e(e){n.length===a&&n.pop(),n.unshift(e)}function t(e){if(n.length>e)for(var t=n.length-e,a=0;t>a;a++)n.pop()}var n=[],a=10;return{setErrorLogLimit:function(e){a=e,t(a)},getErrorLogLimit:function(){return a},logError:function(t){
t.date=new Date,e(t)},getErrorLog:function(){return n}}}),angular.module("oasp.oaspUi.modal").constant("oaspUiModalDefaults",{backdrop:"static",keyboard:!1}).config(["$provide","oaspUiModalDefaults",function(e,t){"use strict";var n=function(e,n){return{open:function(a){n.show();var r=e.open(angular.extend({},t,a));return r.opened.then(function(){n.hide()},function(){n.hide()}),r}}};n.$inject=["$delegate","globalSpinner"],e.decorator("$modal",n)}]),angular.module("oasp.oaspUi.spinner").factory("globalSpinner",["$rootScope","$q",function(e,t){"use strict";var n={show:function(){e.globalSpinner=!0},hide:function(){e.globalSpinner=!1},showOnRouteChangeStartAndHideWhenComplete:function(){e.$on("$stateChangeStart",function(e,t){t.resolve&&n.show()}),e.$on("$stateChangeSuccess",function(){n.hide()}),e.$on("$stateChangeError",function(){n.hide()}),e.$on("$stateNotFound",function(){n.hide()})},decorateCallOfFunctionReturningPromise:function(e){return n.show(),e().then(function(e){return n.hide(),e},function(e){return n.hide(),t.reject(e)})}};return n}]),angular.module("oasp.oaspUi.spinner").constant("spinnerOptions",{lines:13,length:20,width:4,radius:16,corners:1,rotate:0,color:"#ffffff",speed:1.2,trail:54,shadow:!1,hwaccel:!1,zIndex:2e9}).directive("spinner",["spinnerOptions",function(e){"use strict";return{restrict:"A",replace:!0,templateUrl:"oasp/oasp-ui/spinner/spinner.html",scope:{spinnerVisible:"=spinner"},link:function(t){t.spinnerOptions=e}}}]),angular.module("oasp.oaspI18n").controller("LanguageChangeCntl",["$scope","$translate","oaspTranslation",function(e,t,n){"use strict";e.supportedLanguages=n.getSupportedLanguages(),e.changeLanguage=function(e){t.use(e)},e.getCurrentLanguage=function(){return t.use()}}]),angular.module("oasp.oaspI18n").directive("languageChange",function(){"use strict";return{restrict:"EA",scope:!0,replace:!0,controller:"LanguageChangeCntl",templateUrl:"oasp/oasp-i18n/language-change/language-change.html"}}),angular.module("oasp.oaspI18n").provider("oaspTranslation",["$translatePartialLoaderProvider","$translateProvider",function(e,t){"use strict";var n,a=[],r=[],i=function(){var e;if(r&&r.length){for(e=0;e<r.length;e+=1)if(r[e]["default"]===!0)return r[e];return r[0]}return void 0};this.enableTranslationForModule=function(t,r){if(a.indexOf(t)<0&&a.push(t),r===!0){if(n)throw new Error("Default module already specified defaultModule="+n);n=t,e.addPart(n)}},this.setSupportedLanguages=function(e){if(r&&r.length)throw new Error("Supported languages already specified");r=e;var n=i();n&&t.preferredLanguage(n.key)},this.$get=[function(){return{moduleHasTranslations:function(e){return a.indexOf(e)>-1},getDefaultTranslationModule:function(){return n},getSupportedLanguages:function(){return r},getDefaultLanguage:i}}]}]),angular.module("oasp.oaspI18n").service("templateLoadTranslationInterceptor",["$rootScope","oaspTranslation",function(e,t){"use strict";var n=new RegExp("/?([^/]+)/.*html");return{request:function(a){if(a.url){var r=n.exec(a.url);r&&r.length>1&&t.moduleHasTranslations(r[1])&&e.$emit("translationPartChange",r[1])}return a}}}]),angular.module("oasp.templates",[]).run(["$templateCache",function(e){e.put("oasp/oasp-validation/multiline-popover.html",'<div ng-switch="items().length"><span ng-switch-when="1" data-translate="{{items()[0].text}}" data-translate-values="{{items()[0].params}}"></span><ol ng-switch-default=""><li ng-repeat="item in items()"><span data-translate="{{item.text}}" data-translate-values="{{item.params}}"></span></li></ol></div>'),e.put("oasp/oasp-validation/validation-messages.html",'<div><div class="input-with-validation-messages" data-ng-class="{\'input-group\': isInputInvalid()}"><span class="input-group-btn multiline-popover" data-ng-show="isInputInvalid()"><button class="btn btn-danger" type="button" popover-template="\'oasp/oasp-validation/multiline-popover.html\'" popover-placement="auto top" popover-trigger="mouseenter"><i class="glyphicon glyphicon-exclamation-sign"></i></button></span></div></div>'),e.put("oasp/oasp-i18n/language-change/language-change.html",'<li class="dropdown language-dropdown" dropdown=""><a href="" class="dropdown-toggle" dropdown-toggle=""><span class="icon-container"><span class="icon icon-{{getCurrentLanguage()}}-24"></span></span><span translate="">OASP.LANGUAGE</span><span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li ng-repeat="lang in supportedLanguages" ng-show="getCurrentLanguage()!=lang.key"><a ng-click="changeLanguage(lang.key)"><span class="icon icon-{{lang.key}}-24"></span>{{lang.label}}</a></li></ul></li>'),e.put("oasp/oasp-ui/spinner/spinner.html",'<div class="spinner-container" data-ng-show="spinnerVisible"><div class="spinner-backdrop"></div><span us-spinner="spinnerOptions" data-spinner-start-active="1"></span></div>'),e.put("oasp/oasp-ui/button-bar/button-bar.html",'<div class="btn-group btn-group-sm" role="group"><button data-ng-repeat="buttonDef in buttonDefs" data-ng-click="onButtonClick(buttonDef)" data-ng-disabled="isButtonDisabled(buttonDef)" class="btn btn-sm btn-default"><span data-ng-hide="isLabelTranslatable" data-ng-bind="buttonDef.label"></span> <span data-ng-show="isLabelTranslatable" translate="">{{buttonDef.label}}</span></button></div>')}]),angular.module("app.offer-mgmt",["app.main"]),angular.module("app.offer-mgmt").factory("offerManagementRestService",["$http","currentContextPath",function(e,t){"use strict";var n=t.get()+"services/rest/offermanagement/v1";return{getPaginatedOffers:function(t){return e.post(n+"/offer/search",t)},getPaginatedProducts:function(t){return e.post(n+"/product/search",t)}}}]),angular.module("app.offer-mgmt").factory("offers",["offerManagementRestService",function(e){"use strict";return{loadAllOffers:function(){var t={pagination:{page:1,total:!0}};return e.getPaginatedOffers(t).then(function(e){return e.data.result})},loadAllProducts:function(){var t={pagination:{page:1,total:!0}};return e.getPaginatedProducts(t).then(function(e){return e.data.result})}}}]),angular.module("app.sales-mgmt",["app.main","app.offer-mgmt","app.sales-mgmt.templates","ui.grid","ui.grid.selection"]).config(["$stateProvider","oaspAuthorizationServiceProvider","ROLES","oaspTranslationProvider",function(e,t,n,a){"use strict";a.enableTranslationForModule("sales-mgmt"),e.state("salesMgmt",{"abstract":!0,url:"/sales-mgmt",template:"<ui-view/>"}),e.state("salesMgmt.cookPositions",t.usersHavingAnyRoleOf(n.COOK).mayGoToStateDefinedAs({url:"/cook-positions",templateUrl:"sales-mgmt/cook-positions/cook-positions.html",controller:"CookPositionsCntl",controllerAs:"CPC",resolve:{currentPositions:["positions",function(e){return e.get()}]}})),e.state("salesMgmt.cookAssigment",t.usersHavingAnyRoleOf(n.COOK).mayGoToStateDefinedAs({url:"/cook-assigment",templateUrl:"sales-mgmt/cook-assigment/cook-assigment.html",controller:"CookAssigmentCntl",controllerAs:"CAC",resolve:{currentPositions:["positions",function(e){return e.get()}]}}))}]),angular.module("app.sales-mgmt").factory("salesManagementRestService",["$http","currentContextPath",function(e,t){"use strict";var n=t.get()+"services/rest/salesmanagement/v1";return{findOrders:function(t){return e.post(n+"/order/search",t)},saveOrder:function(t){return e.post(n+"/order",t)},updateOrderPosition:function(t){return e.post(n+"/orderposition",t)},findOrderPositions:function(t){return e.get(n+"/orderposition",{params:t})}}}]),angular.module("app.sales-mgmt").factory("sales",["salesManagementRestService",function(e){"use strict";return{loadOrderForTable:function(t){var n={state:"OPEN",tableId:t};return e.findOrders(n).then(function(e){return e.data.result&&e.data.result.length?e.data.result[0]:void 0})},saveOrUpdateOrder:function(t){var n;return n=e.saveOrder(t).then(function(e){return e.data})}}}]),angular.module("app.sales-mgmt").controller("CookAssigmentCntl",["$scope","currentPositions","positions","globalSpinner","positionStateNotification","$q",function(e,t,n,a,r,i){"use strict";function o(){e.gridOptions.data=t?t.availablePositions:[],e.gridOptionsAssigned.data=t?t.positionsAssignedToCurrentUser:[]}function s(){return o(),e.gridApi.core.refresh(),t}r.connect().then(function(){r.subscribe(function(){n.get()})}),e.gridOptions={enableRowSelection:!0,enableSelectAll:!0,selectionRowHeaderWidth:35,rowHeight:35,multiSelect:!0,enableFullRowSelection:!0,enableColumnMenus:!1},e.gridOptions.columnDefs=[{name:"id",displayName:"ID",minWidth:80},{name:"orderId",displayName:"Order ID",minWidth:80},{name:"mealName",displayName:"Meal",minWidth:100},{name:"sideDishName",displayName:"Side Dish",minWidth:100}],e.gridOptionsAssigned=angular.copy(e.gridOptions),o(),e.gridOptions.onRegisterApi=function(t){e.gridApi=t,t.selection.on.rowSelectionChanged(e,function(t){t.isSelected?e.positionsAvailableSelected.push(t.entity):e.positionsAvailableSelected.splice(e.positionsAvailableSelected.indexOf(t.entity),1)})},e.gridOptionsAssigned.onRegisterApi=function(t){e.gridApi=t,t.selection.on.rowSelectionChanged(e,function(t){t.isSelected?e.positionsAssignedSelected.push(t.entity):e.positionsAssignedSelected.splice(e.positionsAssignedSelected.indexOf(t.entity),1)})},e.positionsAvailableSelected=[],e.positionsAssignedSelected=[],e.isAvailablePositionSelected=function(){return e.positionsAvailableSelected&&e.positionsAvailableSelected.length>0?!0:!1},e.isAssignedPositionSelected=function(){return e.positionsAssignedSelected&&e.positionsAssignedSelected.length>0?!0:!1},e.assignCookToPosition=function(){e.isAvailablePositionSelected()&&a.decorateCallOfFunctionReturningPromise(function(){var t=[];return angular.forEach(e.positionsAvailableSelected,function(e){t.push(n.assignCookToPosition(e.id))}),i.all(t).then(function(){return e.positionsAssignedSelected.length=0,e.positionsAvailableSelected.length=0,s()})})},e.buttonDefs=[{label:"SALES_MGMT.DONE",onClick:function(){e.isAssignedPositionSelected()&&a.decorateCallOfFunctionReturningPromise(function(){var t=[];return angular.forEach(e.positionsAssignedSelected,function(e){t.push(n.setPositionStatusToPrepared(e.id))}),i.all(t).then(function(){return e.positionsAssignedSelected.length=0,e.positionsAvailableSelected.length=0,s()})})},isActive:function(){return e.isAssignedPositionSelected()}},{label:"SALES_MGMT.REJECT",onClick:function(){e.isAssignedPositionSelected()&&a.decorateCallOfFunctionReturningPromise(function(){var t=[];return angular.forEach(e.positionsAssignedSelected,function(e){t.push(n.makePositionAvailable(e.id))}),i.all(t).then(function(){return e.positionsAssignedSelected.length=0,e.positionsAvailableSelected.length=0,s()})})},isActive:function(){return e.isAssignedPositionSelected()}}]}]),angular.module("app.sales-mgmt").controller("CookPositionsCntl",["$scope","currentPositions","positions","globalSpinner","positionStateNotification",function(e,t,n,a,r){"use strict";r.connect().then(function(){r.subscribe(function(){n.get()})}),e.positionsAvailableSelected=[],e.positionsAssignedSelected=[],e.positions=t,e.availablePositionSelected=function(){return e.positionsAvailableSelected&&e.positionsAvailableSelected.length>0?!0:!1},e.assignedPositionSelected=function(){return e.positionsAssignedSelected&&e.positionsAssignedSelected.length>0?!0:!1},e.assignCookToPosition=function(){e.availablePositionSelected()&&a.decorateCallOfFunctionReturningPromise(function(){return n.assignCookToPosition(e.positionsAvailableSelected[0].id)})},e.buttonDefs=[{label:"SALES_MGMT.DONE",onClick:function(){e.assignedPositionSelected()&&a.decorateCallOfFunctionReturningPromise(function(){var t=n.setPositionStatusToPrepared(e.positionsAssignedSelected[0].id);return e.positionsAssignedSelected.length=0,t})},isActive:function(){return e.assignedPositionSelected()}},{label:"SALES_MGMT.REJECT",onClick:function(){e.assignedPositionSelected()&&a.decorateCallOfFunctionReturningPromise(function(){var t=n.makePositionAvailable(e.positionsAssignedSelected[0].id);return e.positionsAssignedSelected.length=0,t})},isActive:function(){return e.assignedPositionSelected()}}]}]),angular.module("app.sales-mgmt").factory("positionStateNotification",["currentContextPath","$q",function(e,t){"use strict";var n;return{connect:function(){var a,r,i,o,s={},l=function(){a.resolve()},u=function(){a.reject()},c=n?!1:!0;return c?(a=t.defer(),r=a.promise,i=e.get()+"websocket/positions",o=new SockJS(i),n=Stomp.over(o),n.connect(s,l,u)):r=t.when(),r},subscribe:function(e){var t=function(t){var n=JSON.parse(t.body);angular.isFunction(e)&&e(n)};n&&n.subscribe("/topic/positionStatusChange",t)},notify:function(e,t){var a={id:e,status:t};n&&n.send("/sample/positions",{},JSON.stringify(a))}}}]),angular.module("app.sales-mgmt").factory("positions",["salesManagementRestService","offers","appContext","$q",function(e,t,n,a){"use strict";var r={},i=function(){var e,t={},n=[],a=[],r=[],i={},o=function(e,t){var n,a;if(e&&t)for(n=0;n<e.length;n+=1)if(a=e[n],a.id&&a.id===t)return a},s=function(e){var t,n,i;return e?(t=o(a,e.offerId),t&&(n=o(r,t.mealId),i=o(r,t.sideDishId)),{id:e.id,orderId:e.orderId,offerName:e.offerName,mealName:n&&n.description,sideDishName:i&&i.description}):void 0};return t.allPositions=function(e){return n=e,t},t.currentUserId=function(n){return e=n,t},t.offers=function(e){return a=e,t},t.products=function(e){return r=e,t},t.assignCookToPosition=function(e,t){var a=o(n,t);return a&&(a.cookId=e),a},t.setStatusOfPosition=function(e,t){var a=o(n,t);return a&&(a.state=e),a},t.makePositionUnassigned=function(e){var t=o(n,e);return t&&(t.cookId=void 0),t},t.getAvailableAndAssignedPositions=function(){var t,a,r,o=[],l=[];if(n)for(t=0;t<n.length;t+=1)a=n[t],r=null===a.cookId||void 0===a.cookId,r?o.push(s(a)):e===a.cookId&&l.push(s(a));return i.availablePositions=o,i.positionsAssignedToCurrentUser=l,i},t}();return r.get=function(){var r,o=a.defer();return n.getCurrentUser().then(function(n){r=n.getUserId(),r?a.all([e.findOrderPositions({state:"ORDERED",mealOrSideDish:!0}),t.loadAllOffers(),t.loadAllProducts()]).then(function(e){i.currentUserId(r).allPositions(e[0].data).offers(e[1]).products(e[2]),o.resolve(i.getAvailableAndAssignedPositions())},function(e){o.reject(e)}):o.reject()}),o.promise},r.assignCookToPosition=function(t){var a;return n.getCurrentUser().then(function(n){return a=n.getUserId(),e.updateOrderPosition(i.assignCookToPosition(a,t)).then(function(){return r.get()})})},r.makePositionAvailable=function(t){return e.updateOrderPosition(i.makePositionUnassigned(t)).then(function(){return r.get()})},r.setPositionStatusToPrepared=function(t){return e.updateOrderPosition(i.setStatusOfPosition("PREPARED",t)).then(function(){return r.get()})},r}]),angular.module("app.sales-mgmt.templates",[]).run(["$templateCache",function(e){e.put("sales-mgmt/cook-positions/cook-positions.html",'<!DOCTYPE html><html><body><div class="row cook-positions"><div class="col-md-5"><h2 translate="">SALES_MGMT.AVAILABLE</h2><table class="raw-table" data-tr-ng-grid="" data-selection-mode="SingleRow" data-enable-filtering="true" data-selected-items="positionsAvailableSelected" data-items="positions.availablePositions"></table></div><div class="col-md-2 assignment"><div class="btn-group-vertical" role="group"><button data-ng-click="assignCookToPosition()" data-ng-disabled="!availablePositionSelected()" type="button" class="btn btn-default" aria-label="Left Align"><span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span></button></div></div><div class="col-md-5"><h2 translate="">SALES_MGMT.ASSIGNED</h2><table class="raw-table" data-tr-ng-grid="" data-selection-mode="SingleRow" data-selected-items="positionsAssignedSelected" data-enable-filtering="false" data-items="positions.positionsAssignedToCurrentUser"></table></div></div><div class="row"><div class="col-md-5 col-md-offset-7"><button-bar is-label-translatable="true" button-defs="buttonDefs"></button-bar></div></div></body></html>'),e.put("sales-mgmt/cook-assigment/cook-assigment.html",'<!DOCTYPE html><html><body><div class="row cook-positions"><div class="col-md-5"><h2 translate="">SALES_MGMT.AVAILABLE</h2><div ui-grid="gridOptions" ui-grid-selection="" class=""></div></div><div class="col-md-2 assignment"><div class="btn-group-vertical" role="group"><button data-ng-click="assignCookToPosition()" data-ng-disabled="!isAvailablePositionSelected()" type="button" class="btn btn-default" aria-label="Left Align"><span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span></button></div></div><div class="col-md-5"><h2 translate="">SALES_MGMT.ASSIGNED</h2><div ui-grid="gridOptionsAssigned" ui-grid-selection="" class=""></div></div></div><div class="row"><div class="col-md-5 col-md-offset-7"><button-bar is-label-translatable="true" button-defs="buttonDefs"></button-bar></div></div></body></html>')}]),angular.module("app.table-mgmt",["app.offer-mgmt","app.sales-mgmt","app.main","app.table-mgmt.templates"],["ROLES","$stateProvider","oaspTranslationProvider","oaspAuthorizationServiceProvider",function(e,t,n,a){"use strict";n.enableTranslationForModule("table-mgmt"),t.state("tableMgmt",{"abstract":!0,url:"/table-mgmt",template:"<ui-view/>"}),t.state("tableMgmt.search",a.usersHavingAnyRoleOf(e.WAITER).mayGoToStateDefinedAs({url:"/table-search",templateUrl:"table-mgmt/table-search/table-search.html",controller:"TableSearchCntl",controllerAs:"TSC",resolve:{paginatedTableList:["tables",function(e){return e.getPaginatedTables(1,4).then(function(e){return e})}]}})),t.state("tableMgmt.details",{url:"/table-details/:tableId",templateUrl:"table-mgmt/table-details/table-details.html",controller:"TableDetailsCntl",controllerAs:"TDC"})}]),angular.module("app.table-mgmt").factory("tableManagementRestService",["$http","currentContextPath",function(e,t){"use strict";var n=t.get()+"services/rest/tablemanagement/v1";return{getTable:function(t){return e.get(n+"/table/"+t)},getPaginatedTables:function(t,a){var r={pagination:{size:a,page:t,total:!0}};return e.post(n+"/table/search",r)},createTable:function(t,a){return e.put(n+"/table/"+t,a)},deleteTable:function(t){return e["delete"](n+"/table/"+t)},saveTable:function(t){return e.post(n+"/table/",t)},isTableReleasable:function(t){return e.get(n+"/table/"+t+"/istablereleasable/")}}}]),angular.module("app.table-mgmt").factory("tables",["tableManagementRestService",function(e){"use strict";var t={};return{getPaginatedTables:function(n,a){return e.getPaginatedTables(n,a).then(function(e){return angular.copy(e.data,t),t})},loadTable:function(t){return e.getTable(t).then(function(e){return e.data})},reserve:function(t){return t.state="RESERVED",e.saveTable(t).then(function(){})},free:function(t){return t.state="FREE",e.saveTable(t).then(function(){})},occupy:function(t){return t.state="OCCUPIED",e.saveTable(t).then(function(){})},cancelReservation:function(t){return t.state="FREE",e.saveTable(t).then(function(){})}}}]),angular.module("app.table-mgmt").controller("TableDetailsCntl",["$scope","$sce","$stateParams","tables","offers","sales","globalSpinner","positionStateNotification","$state",function(e,t,n,a,r,i,o,s,l){"use strict";var u=this;u.model={},u.totalItems=0,u.table=[],a.loadTable(n.tableId).then(function(e){u.table=e}),i.loadOrderForTable(n.tableId).then(function(e){u.model.order=e,u.totalItems=angular.isDefined(e)?u.model.order.positions.length:0}),r.loadAllOffers().then(function(e){u.allOffers=e,u.model.selected=e.length?e[0]:void 0}),u.selectedItems=[],u.positionsShown=[],u.numPerPage=3,u.currentPage=1,u.maxSize=4,e.$watch(function(){var e;return angular.isDefined(u.model.order)&&(e=u.model.order.positions),u.currentPage+u.numPerPage+u.totalItems+u.model.order+e},function(){if(angular.isDefined(u.model.order)){var e=(u.currentPage-1)*u.numPerPage,t=e+u.numPerPage;u.positionsShown=u.model.order.positions.slice(e,t),u.totalItems=angular.isDefined(u.model.order.positions)?u.model.order.positions.length:0}}),u.trustAsHtml=function(e){return t.trustAsHtml(e)},u.noOrderAssigned=function(){return!u.model.order},u.orderAssigned=function(){return!u.noOrderAssigned()},u.assignNewOrder=function(){u.model.order={order:{tableId:u.table.id,state:"OPEN"},positions:[]}},u.submit=function(){o.decorateCallOfFunctionReturningPromise(function(){return i.saveOrUpdateOrder(u.model.order)}).then(function(){s.connect().then(function(){var e=u.model.order.positions[0];s.notify(e.id,e.status),u.goToSearchView()})})},u.goToSearchView=function(){l.go("tableMgmt.search")},u.addPosition=function(e){u.model.order.positions.push({revision:null,orderId:u.model.order.order.id,offerId:e.id,offerName:e.description,state:"ORDERED",price:e.price,comment:""}),u.totalItems=u.model.order.positions.length},u.buttonDefs=[{label:"TABLE_MGMT.REMOVE",onClick:function(){u.model.order.positions.splice(u.model.order.positions.indexOf(u.selectedItems[0]),1),u.selectedItems.length=0},isActive:function(){return u.selectedItems.length}}]}]),angular.module("app.table-mgmt").filter("price",function(){"use strict";return function(e){return e+" EUR"}}),angular.module("app.table-mgmt").controller("TableSearchCntl",["$scope","tables","paginatedTableList","$state","globalSpinner",function(e,t,n,a,r){"use strict";var i=function(){return e.selectedItems&&e.selectedItems.length?e.selectedItems[0]:void 0};e.openEditDialog=function(e){a.go("tableMgmt.details",{tableId:e.id})},e.selectedItems=[],e.maxSize=5,e.totalItems=n.pagination.total,e.numPerPage=n.pagination.size,e.currentPage=n.pagination.page,e.gridOptions={data:n.result},e.reloadTables=function(){t.getPaginatedTables(e.currentPage,e.numPerPage).then(function(e){return e}).then(function(t){n=t,e.gridOptions.data=n.result})},e.$watch("currentPage",function(){e.reloadTables()}),e.buttonDefs=[{label:"TABLE_MGMT.EDIT",onClick:function(){e.openEditDialog(i())},isActive:function(){return i()}},{label:"TABLE_MGMT.RESERVE",onClick:function(){r.decorateCallOfFunctionReturningPromise(function(){var n=t.reserve(i()).then(e.reloadTables);return e.selectedItems.length=0,n})},isActive:function(){return i()&&"FREE"===i().state}},{label:"TABLE_MGMT.CANCEL_RESERVATION",onClick:function(){r.decorateCallOfFunctionReturningPromise(function(){var n=t.cancelReservation(i()).then(e.reloadTables);return e.selectedItems.length=0,n})},isActive:function(){return i()&&"RESERVED"===i().state}},{label:"TABLE_MGMT.OCCUPY",onClick:function(){r.decorateCallOfFunctionReturningPromise(function(){var n=t.occupy(i()).then(e.reloadTables);return e.selectedItems.length=0,n})},isActive:function(){return i()&&("RESERVED"===i().state||"FREE"===i().state)}},{label:"TABLE_MGMT.FREE",onClick:function(){r.decorateCallOfFunctionReturningPromise(function(){var n=t.free(i()).then(e.reloadTables);return e.selectedItems.length=0,n})},isActive:function(){return i()&&"OCCUPIED"===i().state}}]}]),angular.module("app.table-mgmt.templates",[]).run(["$templateCache",function(e){e.put("table-mgmt/table-details/table-details.html",'<div><div class="modal-header"><h3 class="modal-title" translate="">TABLE_MGMT.DETAILS<span data-ng-bind="TDC.table.number"></span></h3></div><div class="modal-body"><form name="forms.tableForm" novalidate=""><div class="row"><div class="col-md-12"><label translate="">TABLE_MGMT.TABLE.STATUS</label>&nbsp; <span data-ng-bind="TDC.table.state"></span></div></div><div class="page-header"><h4 translate="">TABLE_MGMT.ORDER</h4></div><div class="row" data-ng-show="TDC.noOrderAssigned()"><div class="col-md-12"><div class="alert alert-info" role="alert">{{\'TABLE_MGMT.NO_ORDER\' | translate}} <a data-ng-click="TDC.assignNewOrder()">{{\'TABLE_MGMT.NEW_ORDER\' | translate}}</a></div></div></div><div data-ng-show="TDC.orderAssigned()"><div class="row"><div class="col-md-12"><label translate="">TABLE_MGMT.TABLE.STATE</label>&nbsp; <span data-ng-bind="TDC.table.order.orderState"></span></div></div><div class="row"><div class="col-md-6"><label translate="">TABLE_MGMT.POSITION</label>&nbsp;</div><div class="col-md-4"><ui-select ng-model="TDC.model.selected"><ui-select-match placeholder="Select offer...">{{$select.selected.description}}</ui-select-match><ui-select-choices repeat="o in TDC.allOffers | filter: $select.search"><div ng-bind-html="TDC.trustAsHtml((o.description | highlight: $select.search))"></div></ui-select-choices></ui-select></div><div class="col-md-1"><button class="btn btn-sm btn-primary" data-ng-click="TDC.addPosition(TDC.model.selected)" translate="">TABLE_MGMT.ADD</button> &nbsp;</div></div><div class="row"><div class="col-md-12"><table class="raw-table" tr-ng-grid="" selection-mode="SingleRow" enable-filtering="false" selected-items="TDC.selectedItems" items="TDC.positionsShown"><thead><tr><th field-name="id" display-name="Number" cell-width="7em"></th><th field-name="offerName" display-name="Title"></th><th field-name="state" display-name="Status"></th><th field-name="price" display-name="Price" display-format="price:gridItem"></th><th field-name="comment" display-name="Comment"></th></tr></thead></table><button-bar is-label-translatable="true" button-defs="TDC.buttonDefs"></button-bar></div></div><pagination total-items="TDC.totalItems" items-per-page="TDC.numPerPage" ng-model="TDC.currentPage" num-pages="TDC.numPages" max-size="TDC.maxSize" class="pagination-sm" boundary-links="true" rotate="false"></pagination></div></form></div><div class="modal-footer"><button class="btn btn-primary" data-ng-disabled="!TDC.model.order" ng-click="TDC.submit()" translate="">TABLE_MGMT.SUBMIT</button> <button class="btn btn-warning" ng-click="TDC.goToSearchView()" translate="">TABLE_MGMT.CANCEL</button></div></div>'),e.put("table-mgmt/table-search/table-search.html",'<!DOCTYPE html><html><body><div class="row"><div class="col-md-12"><h2 translate="">TABLE_MGMT.HEADER</h2><table class="raw-table" tr-ng-grid="" selection-mode="SingleRow" enable-filtering="false" selected-items="selectedItems" items="gridOptions.data"><thead><tr><th field-name="number" display-name="Number" cell-width="7em"></th><th field-name="state" display-name="State"></th><th field-name="waiter" display-name="Waiter"></th></tr></thead></table><button-bar is-label-translatable="true" button-defs="buttonDefs"></button-bar><br><br><br><pagination total-items="totalItems" items-per-page="numPerPage" ng-model="currentPage" num-pages="numPages" class="pagination-sm" boundary-links="true" rotate="false" max-size="maxSize"></pagination></div></div></body></html>')}]),angular.module("app.user-mgmt",["app.main","app.user-mgmt.templates"],["ROLES","$stateProvider","oaspTranslationProvider","oaspAuthorizationServiceProvider",function(e,t,n,a){"use strict";n.enableTranslationForModule("user-mgmt"),t.state("userMgmt",{"abstract":!0,url:"/user-mgmt",template:"<ui-view/>"}),t.state("userMgmt.search",a.usersHavingAnyRoleOf(e.WAITER).mayGoToStateDefinedAs({url:"/user-search",templateUrl:"user-mgmt/user-search/user-search.html",controller:"UserSearchCntl",controllerAs:"USC",resolve:{currentUsers:["users",function(e){return e.loadUsers().then(function(e){return e})}]}})),t.state("userMgmt.create",{url:"/user-create",templateUrl:"user-mgmt/user-create/user-create.html",controller:"UserCreateCntl",controllerAs:"UCC"})}]),angular.module("app.user-mgmt").factory("userManagementRestService",["$http","currentContextPath",function(e,t){"use strict";var n=t.get()+"services/rest/usermanagement/v1";return{getUsers:function(){return e.get(n+"/user")},addUser:function(t){return e.post(n+"/user",t)},delegateGroupsToUser:function(t){return e.post(n+"/user/"+t+"/groups")}}}]),angular.module("app.user-mgmt").factory("users",["userManagementRestService",function(e){"use strict";var t=[];return{loadUsers:function(){return e.getUsers().then(function(e){return angular.copy(e.data,t),t})},createUser:function(t){return e.addUser(t).then(function(e){return e})},delegateGroupsToUser:function(t){return e.delegateGroupsToUser(t).then(function(e){return e})}}}]),angular.module("app.user-mgmt").controller("UserSearchCntl",["$scope","$state","users","currentUsers","globalSpinner",function(e,t,n,a,r){"use strict";e.currentUsers=a,e.selectedItems=[];var i=function(){return e.selectedItems&&e.selectedItems.length?e.selectedItems[0]:void 0};e.openCreateDialog=function(){t.go("userMgmt.create")},e.buttonDefs=[{label:"Neuen Nutzer anlegen",onClick:function(){e.openCreateDialog()},isActive:function(){return!0}},{label:"Als Urlaubsvertretung setzen",onClick:function(){r.decorateCallOfFunctionReturningPromise(function(){var e=n.delegateGroupsToUser(i().userId).then(function(){});return e})},isActive:function(){return i()}}]}]),angular.module("app.user-mgmt").controller("UserCreateCntl",["$scope","globalSpinner","users","$state",function(e,t,n,a){"use strict";var r=this;r.user={},r.submit=function(){t.decorateCallOfFunctionReturningPromise(function(){return n.createUser(r.user)}).then(function(){r.goToSearchView()})},r.goToSearchView=function(){a.go("userMgmt.search")}}]),angular.module("app.user-mgmt.templates",[]).run(["$templateCache",function(e){e.put("user-mgmt/user-create/user-create.html",'<div><div class="modal-header"><h3 class="modal-title" translate="">Neuen Nutzer anlegen</h3></div><div class="modal-body"><form name="tableForm"><div class="row"><div class="col-md-2"><label translate="">Nutzername</label>&nbsp;</div><div class="col-md-4"><input type="text" name="userId" ng-model="UCC.user.userId" required=""> <span class="error" ng-show="tableForm.userId.$touched && tableForm.userId.$invalid">The user identifier is required.</span></div></div><div class="row"><div class="col-md-2"><label translate="">Vorname</label>&nbsp;</div><div class="col-md-4"><input type="text" name="firstName" ng-model="UCC.user.firstName" required=""> <span class="error" ng-show="tableForm.firstName.$touched && tableForm.firstName.$invalid">The first name is required.</span></div></div><div class="row"><div class="col-md-2"><label translate="">Nachname</label>&nbsp;</div><div class="col-md-4"><input type="text" name="lastName" ng-model="UCC.user.lastName" required=""> <span class="error" ng-show="tableForm.lastName.$touched && tableForm.lastName.$invalid">The last name is required.</span></div></div><div class="row"><div class="col-md-2"><label translate="">Passwort</label>&nbsp;</div><div class="col-md-4"><input type="password" name="password" ng-model="UCC.user.password" required=""> <span class="error" ng-show="tableForm.password.$touched && tableForm.password.$invalid">The password is required.</span></div></div><div class="row"><button class="btn btn-primary" ng-click="UCC.submit()" ng-disabled="tableForm.userId.$invalid || tableForm.firstName.$invalid || tableForm.lastName.$invalid">Submit</button> <button class="btn btn-warning" ng-click="UCC.goToSearchView()">Cancel</button></div></form></div><div class="modal-footer"></div></div>'),e.put("user-mgmt/user-search/user-search.html",'<!DOCTYPE html><html><body><div class="row"><div class="col-md-12"><h3>Urlaubsvertretung bestimmen</h3><div>Als Urlaubsvertretung bekommt der Nutzer zeitlich begrenzt Ihre Berechtigungen zugewiesen.</div><br><table class="raw-table" data-tr-ng-grid="" data-selection-mode="SingleRow" data-enable-filtering="false" data-selected-items="selectedItems" data-items="currentUsers" data-fields="[\'username\']"></table><button-bar is-label-translatable="false" button-defs="buttonDefs"></button-bar></div></div></body></html>')}]);